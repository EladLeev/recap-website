<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta charset="utf-8">
    <meta property="og:type" content="website" />
    <meta property="og:title" content="A Schema Language Compatible With JSON, Protobuf, Avro, SQL, Parquet, Arrow, and More... | Recap" />
    <meta property="og:description" content="Recap describes database tables and serialization formats with minimal type coercion" />
    <meta property="og:image" content="https://recap.build/assets/images/og_image.png" />
    <title>A Schema Language Compatible With JSON, Protobuf, Avro, SQL, Parquet, Arrow, and More... | Recap</title>
    <link rel="stylesheet" href="/assets/css/main.css">
    
      <link rel="stylesheet" href="/assets/css/spec.css">
    
  <body class="bg-black">
    <div class="bg-white pt-8 pb-36">
      <a href="/">
        <svg xmlns="http://www.w3.org/2000/svg" width="196" height="44" viewBox="0 0 196 44" fill="none" class="mx-auto">
  <rect width="81.6667" height="43.5556" fill="black"/>
  <rect x="5.44444" y="5.44446" width="5.44444" height="32.6667" fill="white"/>
  <rect x="5.44444" y="5.44446" width="32.6667" height="5.44444" fill="white"/>
  <rect x="43.5556" y="5.44446" width="5.44444" height="32.6667" fill="white"/>
  <rect x="70.7778" y="5.44446" width="5.44444" height="16.3333" fill="white"/>
  <rect x="43.5556" y="5.44446" width="32.6667" height="5.44444" fill="white"/>
  <rect x="43.5556" y="32.6667" width="32.6667" height="5.44444" fill="white"/>
  <rect x="43.5556" y="16.3334" width="32.6667" height="5.44444" fill="white"/>
  <rect x="87.1111" y="5.44446" width="5.44444" height="32.6667" fill="black"/>
  <rect x="87.1111" y="5.44446" width="32.6667" height="5.44444" fill="black"/>
  <rect x="87.1111" y="32.6667" width="32.6667" height="5.44444" fill="black"/>
  <rect x="157.889" y="5.44446" width="5.44444" height="32.6667" transform="rotate(90 157.889 5.44446)" fill="black"/>
  <rect x="157.889" y="16.3334" width="5.44444" height="32.6667" transform="rotate(90 157.889 16.3334)" fill="black"/>
  <rect x="157.889" y="5.44446" width="32.6667" height="5.44444" transform="rotate(90 157.889 5.44446)" fill="black"/>
  <rect x="130.667" y="5.44446" width="32.6667" height="5.44444" transform="rotate(90 130.667 5.44446)" fill="black"/>
  <rect x="196" y="5.44446" width="5.44444" height="32.6667" transform="rotate(90 196 5.44446)" fill="black"/>
  <rect x="196" y="16.3334" width="5.44444" height="32.6667" transform="rotate(90 196 16.3334)" fill="black"/>
  <rect x="196" y="5.44446" width="16.3333" height="5.44444" transform="rotate(90 196 5.44446)" fill="black"/>
  <rect x="168.778" y="5.44446" width="32.6667" height="5.44444" transform="rotate(90 168.778 5.44446)" fill="black"/>
</svg>
      </a>
      <div class="md:max-w-screen-md mx-auto p-4">
        <h1 id="recap-frequently-asked-questions">Recap Frequently Asked Questions</h1>

<h3 id="is-this-a-serialization-format">Is this a serialization format?</h3>

<p>No. Recap does not define how data is persisted to disk. It’s meant to be more of a translation layer to work with data records without worrying whether they came from Avro, JSON, Protobuf, Parquet, or a database.</p>

<h3 id="may-i-define-extra-type-attributes">May I define extra type attributes?</h3>

<p>Yes. Recap will ignore them.</p>

<h3 id="why-did-you-include-enums">Why did you include enums?</h3>

<p>Recap’s type system is constrained enough that enums can’t be expressed as type unions anymore. In a more expressive type system you could say an enum was a union of constant strings (literals). That’s out the window since Recap doesn’t have a literal.</p>

<h3 id="why-didnt-you-include-constraints">Why didn’t you include constraints?</h3>

<p>I plan to add constraints to Recap as a separate add-on spec (similar to <a href="https://json-schema.org/draft/2020-12/json-schema-validation.html">JSON schema’s validators</a>, <a href="https://github.com/bufbuild/protoc-gen-validate">protoc-gen-validate</a>, and <a href="https://beanvalidation.org/2.0-jsr380/">JSR 380</a>). The constraints will be <em>very</em> modest.</p>

<p>I made this decision because I found mixing constraints and types to be difficult. Defining an <code class="language-plaintext highlighter-rouge">int</code> that’s &gt;= 0 and &lt;= 4_294_967_296 is the same range as a uint32, but doesn’t necessarily say anything about the physical format. When you start adding in floats, IEEE standards, and arbitrary precision decimals, these distinctions are important. While they could be encoded in a pure type system, I felt making them explicit–including <code class="language-plaintext highlighter-rouge">bits</code> as an attribute, for example–was more pragmatic. It also aligned with Arrow’s <code class="language-plaintext highlighter-rouge">Schema.fbs</code> does.</p>

<p>Once I committed to keeping constraints separate from types, it felt more natural to keep constraints out of the type spec all together.</p>

<h3 id="why-didnt-you-limit-integer-and-float-bits-to-specific-values-16-32-64-and-so-on">Why didn’t you limit integer and float bits to specific values (16, 32, 64, and so on)?</h3>

<p>I couldn’t find a good reason to. The common bit lengths are implemented as aliases.</p>

<h3 id="why-is-it-called-a-struct">Why is it called a <code class="language-plaintext highlighter-rouge">struct</code>?</h3>

<p>Struct, record, schema, and object are all common. A “schema” containing a “schema” is strange and “objects” usually have methods. “record” could have worked, but seemed less well known. Thus, I went with “struct”.</p>

<h3 id="why-didnt-you-use-a-more-expressive-type-system-like-cue">Why didn’t you use a more expressive type system like CUE?</h3>

<p>Frankly, I’m not an academic and I don’t have enough specialty in type systems to contribute to that area. I did spend time with CUE (and a little with KCL), and found them to be unwieldy. I didn’t want templating, and I only want to include a small set of constraints in Recap. Elaborate type systems and templating felt like overkill.</p>

<p>Kafka Connect is a schema example that is much more constrained than something like CUE, while still modeling most of what Recap wants to model. Kafka Connect has <a href="https://docs.confluent.io/cloud/current/connectors/index.html#preview-connectors">hundreds of source and sink connectors</a>.</p>

<p><a href="https://arrow.apache.org">Apache Arrow</a> is in the same vein as Kafka Connect. In fact, Recap’s base types and many of its <code class="language-plaintext highlighter-rouge">alias</code>es are taken directly from Apache Arrow. Again, Arrow has proven to work with dozens of different databases and data frameworks.</p>

<h3 id="why-didnt-you-use-apache-arrow">Why didn’t you use Apache Arrow?</h3>

<p>For starters, Arrow doesn’t have a schema definition language; it’s entirely programmatic. Their spec is their <a href="https://github.com/apache/arrow/blob/main/format/Schema.fbs">Schema.fbs</a>. You’d have to write code to define a schema; this isn’t what I wanted.</p>

<p>In addition, their in-memory model is more optimized for columnar analytical work. Recap’s main focus is on record-based data from APIs, message buses, and databases. Single record operations and schema manipulation tend to be different than analytical operations. Counting and grouping doesn’t make much sense on a single record. Schema manipulation is where Recap shines: projecting out fields, merging and intersecting schemas, and checking for schema compatibility.</p>

<h3 id="how-do-you-handle-coercion">How do you handle coercion?</h3>

<p>Coercing types that don’t fit cleanly into Recap’s type system is outside the scope of this spec. Recap will include a test suite that defines how specific types are meant to be converted to and from Recap types on a per-SDL basis. For example, converting PostgreSQL’s <code class="language-plaintext highlighter-rouge">geography(point)</code> type to/from a Recap type is something that will be defined in the test suite and documented in the PostgreSQL converter documentation.</p>

      </div>
    </div>
    <div class="footer bg-black grid grid-cols-1 justify-items-center p-8">
      <a href="https://github.com/recap-build/recap">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512" class="w-8 mx-auto mb-4">
  <path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z" fill="white"/>
</svg>
      </a>
      <p class="text-gray-500">
        <a href="/spec">Spec</a> &middot; <a href="/faq">FAQ</a>
      </p>
  </div>
  </body>
</html>
